import 'package:flutter/gestures.dart';
import 'package:flutter/material.dart';

import '../group/group_page.dart';

class Homepage extends StatefulWidget {
  const Homepage({Key? key}) : super(key: key);

  @override
  State<Homepage> createState() => _HomepageState();
}

class _HomepageState extends State<Homepage> {
  TextEditingController idController = TextEditingController();

  final formKey = GlobalKey<FormState>();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text("Group Chat"),
      ),
      body: Center(
        child: TextButton(
          onPressed: () => showDialog(
            context: context,
            builder: (BuildContext context) => AlertDialog(
              title: const Text("Please enter your ID"),
              content: Form(
                key: formKey,
                child: TextFormField(
                  controller: idController,
                  validator: (value) {
                    if (value == null || value.length < 9) {
                      return "User must have a valid ID";
                    }
                    return null;
                  },
                ),
              ),
              actions: [
                // Cancel button
                TextButton(
                  onPressed: () {
                    idController.clear();
                    Navigator.pop(context);
                  },
                  child: const Text(
                    "Cancel",
                    style: TextStyle(fontSize: 16, color: Colors.red),
                  ),
                ),
                // Enter button
                TextButton(
                  onPressed: () {
                    if (formKey.currentState!.validate()) {
                      String id = idController.text;
                      idController.clear();
                      Navigator.pop(context);
                      Navigator.push(
                        context,
                        MaterialPageRoute(
                          builder: (context) => GroupPage(id: id),
                        ),
                      );
                    }
                  },
                  child: const Text(
                    "Enter",
                    style: TextStyle(fontSize: 16, color: Colors.orange),
                  ),
                ),
              ],
            ),
          ),
          child: const Text(
            "Initiate Group Chat",
            style: TextStyle(
              color: Colors.teal,
              fontSize: 16,
            ),
          ),
        ),
      ),
    );
  }
}
